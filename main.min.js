"use strict";!function(){String.prototype.countyMapsToLowerNoSpaces=function(){return this.replace(" ","_").toLowerCase()};var e=angular.module("countyMap",["datamaps"]);e.controller("mapController",["$scope",function(e){function t(t){if(t){var o=_.map(t,function(t){return t[e.key].countyMapsToLowerNoSpaces()});e.tennessee.data=_.mapObject(e.tennessee.data,function(e){return o.indexOf(e)<0?{fillKey:"defaultFill"}:void 0}),o.forEach(function(t){e.tennessee.data[t]={fillKey:"selected"}})}}e.tennessee={scope:"tn_counties",geographyConfig:{dataUrl:"/topo_tn_counties.json",highlightOnHover:!1},options:{staticGeoData:!0},fills:{selected:"#a55",defaultFill:"#9cf"},data:{},setProjection:function(t){var o=t.childNodes[0];o.attributes.width.value="849",o.attributes.height.value="238",o.setAttribute("viewBox","377 44 800 190"),e.options&&e.options.classes&&e.options.classes.forEach(function(e){o.classList.add(e)});var n=d3.geo.mercator().center([-86.7833,36.1667]).scale(5e3).rotate([8,0]).translate([0,100]),s=d3.geo.path().projection(n);return{path:s,projection:n}}},e.options&&e.options.fills&&(e.tennessee.fills.selected=e.options.fills.selected||"#a55",e.tennessee.fills.defaultFill=e.options.fills.defaultFill||"#99ccff");var o=e.$watch("selectedCounties",function(e){t(e)},!0);e.$on("$destroy",o),e.toggleCounty=e.options&&e.options.multiple?function(t){var o=_.filter(e.selectedCounties,function(o){return o[e.key].countyMapsToLowerNoSpaces()===t.id.countyMapsToLowerNoSpaces()}),n=_.find(e.counties,function(o){return o[e.key].countyMapsToLowerNoSpaces()===t.id.countyMapsToLowerNoSpaces()}),s=e.selectedCounties.indexOf(n);o.length?e.selectedCounties.splice(s,1):e.selectedCounties.push(n),e.$apply(),e.options.onAfterCountySelect&&e.options.onAfterCountySelect(n,t)}:function(t){var o=_.find(e.counties,function(o){return o[e.key].countyMapsToLowerNoSpaces()===t.id.countyMapsToLowerNoSpaces()});e.selectedCounties=e.selectedCounties[0]===o?[]:[o],e.$apply(),e.options&&e.options.onAfterCountySelect&&e.options.onAfterCountySelect(o,t)}}])}();
